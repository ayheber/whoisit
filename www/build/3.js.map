{"version":3,"sources":["../../src/pages/end-game/end-game.module.ts","../../src/pages/end-game/end-game.ts"],"names":[],"mappings":"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","file":"3.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { EndGamePage } from './end-game';\n\n@NgModule({\n  declarations: [\n    EndGamePage,\n  ],\n  imports: [\n    IonicPageModule.forChild(EndGamePage),\n  ],\n})\nexport class EndGamePageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/end-game/end-game.module.ts","import { Component } from '@angular/core';\nimport { IonicPage, NavController, NavParams } from 'ionic-angular';\nimport { AngularFireDatabase } from 'angularfire2/database';\nimport { UserModel } from '../../Models/user.model';\nimport { RoundModel } from '../../Models/round.model';\n\n@IonicPage()\n@Component({\n  selector: 'page-end-game',\n  templateUrl: 'end-game.html',\n})\nexport class EndGamePage {\n\n  usersModel: UserModel[] = [];\n  roomKey: string;\n  roundKey: string;\n  constructor(public navCtrl: NavController, public navParams: NavParams,  public af: AngularFireDatabase) {\n\n    this.roomKey = this.navParams.get('roomKey');\n    this.roundKey = this.navParams.get('roundKey');\n\n    if(this.roundKey != null) {\n          this.af.object(`rounds/${this.roundKey}/votesCount`).set(0);\n          this.af.object(`rounds/${this.roundKey}/votes/dummy`).set(true);\n    } \n    else {\n      this.af.list(`rounds/`).subscribe( t=> {\n        t.forEach( room => {\n          if(room.val().roomKey == this.roomKey){\n            this.roomKey = room.val().key;\n            return;\n          }\n        });\n      });\n    }\n\n    // get the users in the current room\n    af.list(`rooms/${this.roomKey}/users`).subscribe( snapshots => {\n      this.usersModel = [];\n      \n      snapshots.forEach( snapshot=> {\n        let userId = snapshot.$key;\n        af.object(`users/${userId}`).subscribe( t=> {\n          this.usersModel.push(t);\n        });\n      });\n    });\n\n    // wait till all users will vote\n    af.object(`rounds/${this.roundKey}/isAllVoted`).subscribe( t=> {\n        if(t.$value) {\n          this.navCtrl.push('ScorePage', {\n            roundKey: this.roundKey,\n            roomKey: this.roomKey\n          });\n        }\n    });\n  }\n\n\n  selectUser(user: UserModel) {\n    let counter = 0;  \n    let subscribtion = this.af.object(`/rounds/${this.roundKey}/votes/${user.$key}`).subscribe(user => {\n      counter = user.$value;\n      subscribtion.unsubscribe();\n      counter++;\n      this.af.object(`/rounds/${this.roundKey}/votes/${user.$key}`).set(counter);\n    });\n\n    //this.navCtrl.push('cat');\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/end-game/end-game.ts"],"sourceRoot":""}