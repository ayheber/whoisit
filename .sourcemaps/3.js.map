{"version":3,"sources":["../../src/pages/end-game/end-game.module.ts","../../src/pages/end-game/end-game.ts"],"names":[],"mappings":"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","file":"3.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { EndGamePage } from './end-game';\n\n@NgModule({\n  declarations: [\n    EndGamePage,\n  ],\n  imports: [\n    IonicPageModule.forChild(EndGamePage),\n  ],\n})\nexport class EndGamePageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/end-game/end-game.module.ts","import { Component } from '@angular/core';\nimport { IonicPage, NavController, NavParams } from 'ionic-angular';\nimport { AngularFireDatabase } from 'angularfire2/database';\nimport { UserModel } from '../../Models/user.model';\nimport { StatModel } from '../../Models/stat.model';\n\n@IonicPage()\n@Component({\n  selector: 'page-end-game',\n  templateUrl: 'end-game.html',\n})\nexport class EndGamePage {\n\n  usersModel: UserModel[] = [];\n  roomKey: string;\n  statKey: string\n  constructor(public navCtrl: NavController, public navParams: NavParams,  public af: AngularFireDatabase) {\n\n    this.roomKey = this.navParams.get('roomKey');\n    \n    // crearing and adding new stat model to db\n    let statModel: StatModel = {\n      roomKey: this.roomKey\n    }\n\n    this.statKey = this.af.list(`/games/`).push(statModel).key;\n    this.af.object(`games/${this.statKey}/votesCount`).set(0);\n\n    // get the users in the current room\n    af.list(`rooms/${this.roomKey}/users`).subscribe( snapshots => {\n      this.usersModel = [];\n      \n      snapshots.forEach( snapshot=> {\n        let userId = snapshot.$key;\n        af.object(`users/${userId}`).subscribe( t=> {\n          this.usersModel.push(t);\n          //this.af.object(`games/${this.statKey}/votes/${userId}`).set(0);\n        });\n      });\n    });\n\n    // wait till all users will vote\n    af.object(`games/${this.statKey}/isAllVoted`).subscribe( t=> {\n        if(t.$value) {\n          this.navCtrl.push('ScorePage', {\n            statId: this.statKey\n          });\n        }\n    });\n  }\n\n\n  selectUser(user: UserModel) {\n    let counter = 0;  \n    let subscribtion = this.af.object(`/games/${this.statKey}/votes/${user.$key}`).subscribe(user => {\n      counter = user.$value;\n      subscribtion.unsubscribe();\n      counter++;\n      this.af.object(`/games/${this.statKey}/votes/${user.$key}`).set(counter);\n    });\n\n    //this.navCtrl.push('cat');\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/end-game/end-game.ts"],"sourceRoot":""}